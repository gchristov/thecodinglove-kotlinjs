FROM nginx:1.25.3

ARG SEARCH_SERVICE_HOST
ARG SEARCH_SERVICE_PATH
ARG SEARCH_SERVICE_PUBSUB_PATH
ARG STATISTICS_SERVICE_HOST
ARG STATISTICS_SERVICE_PATH
ARG SELF_DESTRUCT_SERVICE_HOST
ARG SELF_DESTRUCT_SERVICE_PATH
ARG SLACK_SERVICE_HOST
ARG SLACK_SERVICE_PATH
ARG SLACK_SERVICE_PUBSUB_PATH
ARG LANDING_PAGE_WEB_SERVICE_HOST
# Need to forward the nginx env variables manually for production. Locally we use Docker Compose which does this automatically.
ENV SEARCH_SERVICE_HOST=${SEARCH_SERVICE_HOST}
ENV SEARCH_SERVICE_PATH=${SEARCH_SERVICE_PATH}
ENV SEARCH_SERVICE_PUBSUB_PATH=${SEARCH_SERVICE_PUBSUB_PATH}
ENV STATISTICS_SERVICE_HOST=${STATISTICS_SERVICE_HOST}
ENV STATISTICS_SERVICE_PATH=${STATISTICS_SERVICE_PATH}
ENV SELF_DESTRUCT_SERVICE_HOST=${SELF_DESTRUCT_SERVICE_HOST}
ENV SELF_DESTRUCT_SERVICE_PATH=${SELF_DESTRUCT_SERVICE_PATH}
ENV SLACK_SERVICE_HOST=${SLACK_SERVICE_HOST}
ENV SLACK_SERVICE_PATH=${SLACK_SERVICE_PATH}
ENV SLACK_SERVICE_PUBSUB_PATH=${SLACK_SERVICE_PUBSUB_PATH}
ENV LANDING_PAGE_WEB_SERVICE_HOST=${LANDING_PAGE_WEB_SERVICE_HOST}

COPY ./default.conf.template /etc/nginx/templates/default.conf.template
